{
  "version": 3,
  "sources": ["../../weq8/dist/runtime.js"],
  "sourcesContent": ["import { g as a, a as o } from \"./functions.697e57cd.js\";\nlet p = () => ({\n  events: {},\n  emit(r, ...e) {\n    let t = this.events[r] || [];\n    for (let i = 0, s = t.length; i < s; i++)\n      t[i](...e);\n  },\n  on(r, e) {\n    var t;\n    return (t = this.events[r]) != null && t.push(e) || (this.events[r] = [e]), () => {\n      var i;\n      this.events[r] = (i = this.events[r]) == null ? void 0 : i.filter((s) => e !== s);\n    };\n  }\n});\nconst u = [\n  \"lowpass12\",\n  \"lowpass24\",\n  \"highpass12\",\n  \"highpass24\",\n  \"bandpass12\",\n  \"bandpass24\",\n  \"lowshelf12\",\n  \"lowshelf24\",\n  \"highshelf12\",\n  \"highshelf24\",\n  \"peaking12\",\n  \"peaking24\",\n  \"notch12\",\n  \"notch24\"\n], g = [\n  { type: \"lowshelf12\", frequency: 30, gain: 0, Q: 0.7, bypass: !1 },\n  { type: \"peaking12\", frequency: 200, gain: 0, Q: 0.7, bypass: !1 },\n  { type: \"peaking12\", frequency: 1e3, gain: 0, Q: 0.7, bypass: !1 },\n  { type: \"highshelf12\", frequency: 5e3, gain: 0, Q: 0.7, bypass: !1 },\n  { type: \"noop\", frequency: 350, gain: 0, Q: 1, bypass: !1 },\n  { type: \"noop\", frequency: 350, gain: 0, Q: 1, bypass: !1 },\n  { type: \"noop\", frequency: 350, gain: 0, Q: 1, bypass: !1 },\n  { type: \"noop\", frequency: 350, gain: 0, Q: 1, bypass: !1 }\n];\nclass b {\n  constructor(e, t = g, i = u) {\n    this.audioCtx = e, this.spec = t, this.supportedFilterTypes = i, this.filterbank = [], this.input = e.createGain(), this.output = e.createGain(), this.buildFilterChain(t), this.emitter = p();\n  }\n  connect(e) {\n    this.output.connect(e);\n  }\n  disconnect(e) {\n    this.output.disconnect(e);\n  }\n  on(e, t) {\n    return this.emitter.on(e, t);\n  }\n  setFilterType(e, t) {\n    var i;\n    if (t === \"noop\" && this.spec[e].type !== \"noop\" && !this.spec[e].bypass ? this.disconnectFilter(e) : t !== \"noop\" && this.spec[e].type === \"noop\" && !this.spec[e].bypass && this.connectFilter(e, t), this.spec[e].type = t, t !== \"noop\" && !this.spec[e].bypass) {\n      let s = (i = this.filterbank.find((n) => n.idx === e)) == null ? void 0 : i.filters;\n      if (!s)\n        throw new Error(\"Assertion failed: No filters in filterbank\");\n      for (let n of s)\n        n.type = a(t);\n      let l = o(t);\n      for (; s.length > l; ) {\n        let n = s.length - 1, h = s[n], f = s[n - 1], c = this.getNextInChain(e);\n        h.disconnect(), f.disconnect(h), f.connect(c), s.splice(n, 1);\n      }\n      for (; s.length < l; ) {\n        let n = this.audioCtx.createBiquadFilter();\n        n.type = a(t), n.frequency.value = this.spec[e].frequency, n.Q.value = this.spec[e].Q, n.gain.value = this.spec[e].gain;\n        let h = s[s.length - 1], f = this.getNextInChain(e);\n        h.disconnect(f), h.connect(n), n.connect(f), s.push(n);\n      }\n    }\n    this.emitter.emit(\"filtersChanged\", this.spec);\n  }\n  toggleBypass(e, t) {\n    t && !this.spec[e].bypass && this.spec[e].type !== \"noop\" ? this.disconnectFilter(e) : !t && this.spec[e].bypass && this.spec[e].type !== \"noop\" && this.connectFilter(e, this.spec[e].type), this.spec[e].bypass = t, this.emitter.emit(\"filtersChanged\", this.spec);\n  }\n  disconnectFilter(e) {\n    var l;\n    let t = (l = this.filterbank.find((n) => n.idx === e)) == null ? void 0 : l.filters;\n    if (!t)\n      throw new Error(\"Assertion failed: No filters in filterbank when disconnecting filter. Was it connected?\");\n    let i = this.getPreviousInChain(e), s = this.getNextInChain(e);\n    i.disconnect(t[0]), t[t.length - 1].disconnect(s), i.connect(s), this.filterbank = this.filterbank.filter((n) => n.idx !== e);\n  }\n  connectFilter(e, t) {\n    let i = Array.from({ length: o(t) }, () => {\n      let n = this.audioCtx.createBiquadFilter();\n      return n.type = a(t), n.frequency.value = this.spec[e].frequency, n.Q.value = this.spec[e].Q, n.gain.value = this.spec[e].gain, n;\n    }), s = this.getPreviousInChain(e), l = this.getNextInChain(e);\n    s.disconnect(l), s.connect(i[0]);\n    for (let n = 0; n < i.length - 1; n++)\n      i[n].connect(i[n + 1]);\n    i[i.length - 1].connect(l), this.filterbank.push({ idx: e, filters: i });\n  }\n  setFilterFrequency(e, t) {\n    this.spec[e].frequency = t;\n    let i = this.filterbank.find((s) => s.idx === e);\n    if (i)\n      for (let s of i.filters)\n        s.frequency.value = t;\n    this.emitter.emit(\"filtersChanged\", this.spec);\n  }\n  setFilterQ(e, t) {\n    this.spec[e].Q = t;\n    let i = this.filterbank.find((s) => s.idx === e);\n    if (i)\n      for (let s of i.filters)\n        s.Q.value = t;\n    this.emitter.emit(\"filtersChanged\", this.spec);\n  }\n  setFilterGain(e, t) {\n    this.spec[e].gain = t;\n    let i = this.filterbank.find((s) => s.idx === e);\n    if (i)\n      for (let s of i.filters)\n        s.gain.value = t;\n    this.emitter.emit(\"filtersChanged\", this.spec);\n  }\n  getFrequencyResponse(e, t, i, s, l) {\n    let n = this.filterbank.find((h) => h.idx === e);\n    return n ? (n.filters[t].getFrequencyResponse(i, s, l), !0) : !1;\n  }\n  buildFilterChain(e) {\n    this.filterbank = [];\n    for (let t = 0; t < e.length; t++) {\n      let i = e[t];\n      if (i.type === \"noop\" || i.bypass)\n        continue;\n      let s = Array.from({ length: o(i.type) }, () => {\n        let l = this.audioCtx.createBiquadFilter();\n        return l.type = a(i.type), l.frequency.value = i.frequency, l.Q.value = i.Q, l.gain.value = i.gain, l;\n      });\n      this.filterbank.push({ idx: t, filters: s });\n    }\n    if (this.filterbank.length === 0)\n      this.input.connect(this.output);\n    else\n      for (let t = 0; t < this.filterbank.length; t++) {\n        let { filters: i } = this.filterbank[t];\n        t === 0 ? this.input.connect(i[0]) : this.filterbank[t - 1].filters[this.filterbank[t - 1].filters.length - 1].connect(i[0]);\n        for (let s = 0; s < i.length - 1; s++)\n          i[s].connect(i[s + 1]);\n        t === this.filterbank.length - 1 && i[i.length - 1].connect(this.output);\n      }\n  }\n  getPreviousInChain(e) {\n    let t = this.input, i = -1;\n    for (let s of this.filterbank)\n      s.idx < e && s.idx > i && (t = s.filters[s.filters.length - 1], i = s.idx);\n    return t;\n  }\n  getNextInChain(e) {\n    let t = this.output, i = this.spec.length;\n    for (let s of this.filterbank)\n      s.idx > e && s.idx < i && (t = s.filters[0], i = s.idx);\n    return t;\n  }\n}\nexport {\n  b as WEQ8Runtime\n};\n"],
  "mappings": "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",
  "names": ["i", "l"]
}
